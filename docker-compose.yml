version: '3.4'
services:

  nginx:
    image: nginx
    ports:
      - 80:80
      - 7878:7878
      - 8989:8989
      - 9117:9117
    networks:
      - default
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/conf.d/default.conf:ro
      - ./nginx/htpasswd:/htpasswd

  openvpn:
    image: dperson/openvpn-client
    cap_add:
      - net_admin
    environment:
      TZ: ${TZ}
    networks:
      - default
    dns:
      - 209.222.18.222
      - 209.222.18.218
    read_only: true
    tmpfs:
      - /tmp
    restart: unless-stopped
    security_opt:
      - label:disable
    stdin_open: true
    tty: true
    volumes:
      - /dev/net:/dev/net:z
      - ./openvpn:/vpn:ro

  rutorrent:
    image: linuxserver/rutorrent
    depends_on:
      - openvpn
    environment:
      TZ: ${TZ}
      PGID: ${PGID}
      PUID: ${PUID}
    network_mode: service:openvpn
    volumes:
      - ${RUTORRENT_CONFIG}:/config
      - ${RUTORRENT_DOWNLOADS}:/downloads

  jackett:
    image: linuxserver/jackett
    depends_on:
      - openvpn
    environment:
      TZ: ${TZ}
      PGID: ${PGID}
      PUID: ${PUID}
    network_mode: service:openvpn
    volumes:
      - ${JACKETT_CONFIG}:/config
      - ${JACKETT_DOWNLOADS}:/downloads

  radarr:
    image: linuxserver/radarr
    depends_on:
      - openvpn
    environment:
      TZ: ${TZ}
      PGID: ${PGID}
      PUID: ${PUID}
    network_mode: service:openvpn
    volumes:
      - ${RADARR_CONFIG}:/config
      - ${RADARR_DOWNLOADS}:/downloads
      - ${RADARR_MOVIES}:/movies

  sonarr:
    image: linuxserver/sonarr
    depends_on:
      - openvpn
    environment:
      TZ: ${TZ}
      PGID: ${PGID}
      PUID: ${PUID}
    network_mode: service:openvpn
    volumes:
      - ${SONARR_CONFIG}:/config
      - ${SONARR_DOWNLOADS}:/downloads
      - ${SONARR_TV}:/tv

networks:
  default:
